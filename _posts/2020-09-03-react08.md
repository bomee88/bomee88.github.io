---
title : "[패스트캠퍼스 수강 후기] 프론트엔드 인강 100% 환급 챌린지 23회차 미션 - 30강 React useEffect, useMemo"
date : 2020-09-03
categories : fastcampus 
tags : fastcampus all-in-one-challenge day23 react 
---
# useEffect Hook
리액트 화면이 처음 나타날때, 상태가 바뀔때, 랜더링이 될때마다 어떤 작업을 수행할 수 있다. 한번 코드로 확인해보도록 하자. 우선 우리가 만든 UserList가 마운트될때와 언마운트될때 (나타날때, 사라질때) 효과를 줘 볼 것이다.
  
> UserList.js  

```javascript
import React, { useEffect } from 'react'; //1. useEffect 선언

function User({ user, onRemove, onToggle }){
    const {username, email, id, active} = user;
    useEffect(()=>{ //2. 첫번째 파라미터에는 마운트시 실행할 것을 넣어줌. 
        console.log('컴포넌트가 화면에 나타남 - 마운트');
        return () => { //4. 함수를 반환하면 삭제할때 실행됨. = 클리너함수
            console.log('컴포넌트가 화면에서 사라짐 - 언마운트');
        }
    }, [])//3. 두번째 파라미터에는 비어있는 배열을 넣어줄건데 이 배열을 deps라고 부름(dependency) 의존되는 값을 배열에 넣어줄 껀데 만약에 그 의존되는 배열값이 비어있으면 처음 화면에 나타날때만 실행이 됨.
    return(
        <div>
            <b
             style={{
                color: active ? 'green' : 'black',
                cursor: 'pointer'
            }}
            onClick={() => onToggle(id)}
            >
                {username}
            </b>
            &nbsp;
            <span>({email})</span>
            <button onClick={() => onRemove(id)}>삭제</button> 
        </div>
    )
}

function UserList({ users, onRemove, onToggle }){
    return(
        <div>
            {
                users.map(
                    (user, index) => (
                    <User 
                        user={user} 
                        key={user.id}
                        onRemove={onRemove}
                        onToggle={onToggle}
                    />) 
                )
            }
        </div>
    )
}

export default UserList;
```
위와 같은 순서대로 useEffect를 상단에 선언해주고 User함수 안에서 useEffect를 불러와보자.  
먼저 **컴포넌트가 마운트될때 (화면에 UI가 나타날때) 우리가 주로 수행하는 일**들은  
1. props => state : 프로프로 받은 값을 스테이트로 설정하는 것
1. REST API : 외부 API요청할때
1. D3 Video.js : 라이브러리를 사용할때
1. setInterval, setTimeout 
그리고 참고로 마운트 된 상태란, 우리의 UI가 이미 나오고 난 상태 이후이다. 여기서 바로 DOM에 접근하는 작업들을 해도 문제가 없다. (j-query 코딩시를 떠올려보면 $(window).load에 넣던 내용이지 않을까 싶음.)
두번째로 **컴포넌트가 언마운트될때 (화면에 UI가 사라질때) 우리가 주로 수행하는 일**은
1. clearInterval, clearTimeout : setInterval, setTimeout을 제거할때 
1. 라이브러리 인스턴스를 제거할때
이렇게 있다. 마운트는 위와 같이 useEffect를 불러오면서 써주면 되고, 언마운트는 return에 함수를 만들면서 써주면 된다. 그리고 useEffect의 두번째 파라미터인 ','하고 써주는 부분에 빈 배열을 넣으면 화면 UI가 처음 보일때만 실행한다. 만약 이곳에 props로 받아온 값을 넣어주면 그 props가 리랜더링 된다던지, 업데이트 될때도 실행이 된다. 그 부분에 대해서 코드로 더 알아보도록 하자.

> UserList.js 에서 User함수만

```javascript
function User({ user, onRemove, onToggle }){
    const {username, email, id, active} = user;
    useEffect(()=>{
        console.log('user 값이 설정됨');
        console.log(user);
        return () => {
            console.log('user 값이 바뀌기 전');
            console.log(user);
        }
    },[user]);
    return(
        <div>
            <b
             style={{
                color: active ? 'green' : 'black',
                cursor: 'pointer'
            }}
            onClick={() => onToggle(id)}
            >
                {username}
            </b>
            &nbsp;
            <span>({email})</span>
            <button onClick={() => onRemove(id)}>삭제</button> 
        </div>
    )
}
```
![리액트이미지](/images/200903-1.png)  
위와 같이 두번째 파라미터 부분이 빈 배열이였을땐 전체 화면이 업데이트 될때만 useEffect가 실행됐었는데, 배열에 user로 받아온 props를 넣어주니 그 부분이 업데이트 될때마다 useEffect가 실행되는 것을 볼 수 있다.  
여기서 기억해야할 것은 만약에 useEffect에서 props를 사용했는데 배열에 그 props를 넣어주지 않으면 최신 props상태를 받아오지 못해 제대로 작동이 안될 수도 있다는 점이다. 이 부분을 꼭 유의하도록 하자.  
그런데 만약 배열부분(=deps, =dependency)을 아예 안쓰면 어떻게 될까?   
User컴포넌트의 부모 컴포넌트인 UserList컴포넌트 전체가 리랜더링 된다. 나중에 항목들이 많아지게 된다면 deps를 안쓰면 전체를 리랜더링 하니까 느려질 수도 있다.  
정리하자면 
1. useEffect를 사용할때에는 첫번째 파라미터에는 함수를 등록하고 두번째 파라미터에는 deps라는 배열을 등록한다.
1. return 함수를 반환하게 되면 뒷정리해주는 cleaner함수여서 UI가 사라질 때(and 업데이트 되기 바로 직전) 호출이 된다. 
1. 함수내에서 props를 사용해줬다면 deps배열에 꼭 등록을 해줘야 문제가 안생긴다.
1. deps배열이 비어있다면 컴포넌트가 처음 나타날때에만 호출이 된다.
1. deps배열에 props가 들어있다면, useEffect안의 함수는 컴포넌트가 처음 나타날때, props가 업데이트될때 호출이 되며, 그 안에 있는 cleaner함수는 props가 바뀌가 바로 직전에도 호출이 되고, 컴포넌트가 사라지기 전에도 호출이 된다.

# useMemo Hook



오늘은 여기까지..    
시청 영상 30강 17~18까지  
![수강인증이미지](/images/200903-2.jpeg)   
   
프론트엔드 개발 올인원 패키지 with React Online. 👉 https://bit.ly/31Cf1hp