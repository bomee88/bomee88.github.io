---
title : "[íŒ¨ìŠ¤íŠ¸ìº í¼ìŠ¤ ìˆ˜ê°• í›„ê¸°] í”„ë¡ íŠ¸ì—”ë“œ ì¸ê°• 100% í™˜ê¸‰ ì±Œë¦°ì§€ 28íšŒì°¨ ë¯¸ì…˜ - 30ê°• Custom Hook, context API"
date : 2020-09-06
categories : fastcampus 
tags : fastcampus all-in-one-challenge day27 react 
---
# Custom Hook
ì»´í¬ë„ŒíŠ¸ë¥¼ ë§Œë“¤ë‹¤ë³´ë©´ ë°˜ë³µì ì¸ ë¡œì§ë“¤ì´ ë°œê²¬ëœë‹¤. ì˜ˆë¥¼ë“¤ì–´ ì•„ë˜ì™€ ê°™ì´ ì¸í’‹ì„ ê´€ë¦¬í•˜ëŠ” ì½”ë“œëŠ” ê½¤ë‚˜ ìì£¼ ë°œìƒí•˜ëŠ” ì½”ë“œë‹¤. ì´ëŸ° ê²½ìš° ìš°ë¦¬ëŠ” Custom Hookì„ ë§Œë“¤ì–´ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. 
![ë¦¬ì•¡íŠ¸ì½”ë“œ](/images/200906-1.png)
ê·¸ëŸ¼ ì§ì ‘ ë§Œë“¤ì–´ë³´ì. useInputs.jsë¼ëŠ” ì»¤ìŠ¤í…€ í›… íŒŒì¼ì„ ìƒˆë¡œ ë§Œë“ ë‹¤.

> useInputs.js (useStateí™œìš©)   

```javascript
import { useState, useCallback } from 'react';

function useInputs(initialForm){
    const [form, setForm] = useState(initialForm);
    const onChange = useCallback(e => {
        const {name, value} = e.target;
        setForm(form => ({...form, [name]: value}));
    }, []);
    const reset = useCallback(() => setForm(initialForm), [initialForm]);
    
    return[form, onChange, reset];
};
export default useInputs;
```
ì»¤ìŠ¤ì»´í›…ì„ ë§Œë“¤ë•ŒëŠ” ì´ë ‡ê²Œ useë¼ëŠ” ì´ë¦„ê³¼ ê¸°ëŠ¥(Inputs)ì´ë ‡ê²Œ ì„ì–´ì„œ í•¨ìˆ˜ë¥¼ ë§Œë“ ë‹¤. ìš°ë¦¬ëŠ” ì´ë²ˆ í›…ì„ ë§Œë“¤ë•Œ useStateë¥¼ ì‚¬ìš©í•´ì„œ ë§Œë“¤ì—ˆë‹¤. useStateë§ê³  useReducerë¡œë„ ë§Œë“¤ ìˆ˜ ìˆë‹¤. 

> useInputs.js (useReducerí™œìš©)  

```javascript
import { useReducer, useCallback } from 'react';

function reducer(state, action) {
  switch (action.type) {
    case 'CHANGE':
      return {
        ...state,
        [action.name]: action.value
      };
    case 'RESET':
      return Object.keys(state).reduce((acc, current) => {
        acc[current] = '';
        return acc;
      }, {});
    default:
      return state;
  }
}

function useInputs(initialForm) {
  const [form, dispatch] = useReducer(reducer, initialForm);
  // change
  const onChange = useCallback(e => {
    const { name, value } = e.target;
    dispatch({ type: 'CHANGE', name, value });
  }, []);
  const reset = useCallback(() => dispatch({ type: 'RESET' }), []);
  return [form, onChange, reset];
}

export default useInputs;
```
useReducerë¥¼ í™œìš©í•˜ë©´ ìœ„ì™€ ê°™ì´ ì‘ì„±í•  ìˆ˜ ìˆë‹¤. ì´ì œ App.jsë¥¼ ì•„ë˜ì™€ ê°™ì´ ìˆ˜ì •í•´ë³´ì. 
> App.js   

```javascript
import React, { useRef, useReducer, useMemo, useCallback } from 'react';
import UserList from './UserList';
import CreateUser from './CreateUser';
import useInputs from './useInputs';

function countActiveUsers(users){
  console.log('í™œì„± ì‚¬ìš©ì ìˆ˜ë¥¼ ì„¸ëŠ”ì¤‘...');
  return users.filter(user => user.active).length;
}

const initialState = {
  users: [
      {
        id: 1,
        username: 'bmyu',
        email: 'bomee88@naver.com',
        active: true,
    },
    {
        id: 2,
        username: 'tester',
        email: 'tester@example.com',
        active: false,
    },
    {
        id: 3,
        username: 'sample',
        email: 'sample@example.com',
        active: false,
    }
  ]
}

function reducer(state, action){
  switch (action.type){
    case 'CREATE_USER':
      return {
        inputs: initialState.inputs,
        users: state.users.concat(action.user)
      }
    case 'TOGGLE_USER':
      return {
        ...state,
        users: state.users.map(user =>
          user.id === action.id
          ? { ...user, active: !user.active }
          : user
          )
      };
    case 'REMOVE_USER':
      return {
        ...state,
        users: state.users.filter(user => user.id !== action.id)
      }
    default:
      throw new Error('Unhandled action');
  }
}

function App() {
  const [state, dispatch] = useReducer(reducer, initialState);
  const [form, onChange, reset] = useInputs({
    username: '',
    email: '',
  });
  const { username, email } = form;
  const nextId = useRef(4);
  const { users } = state;


  const onCreate = useCallback(() => {
    dispatch({
      type: 'CREATE_USER',
      user: {
        id: nextId.current,
        username,
        email,
      }
    });
    nextId.current += 1;
    reset();
  }, [username, email, reset]);

  const onToggle = useCallback (id => {
    dispatch({
      type: 'TOGGLE_USER',
      id
    })
  },[]);

  const onRemove = useCallback (id => {
    dispatch({
      type: 'REMOVE_USER',
      id
    })
  },[]);

  const count = useMemo(() => countActiveUsers(users),[users])

  return(
    <>
      <CreateUser 
        username={username} 
        email={email} 
        onChange={onChange}
        onCreate={onCreate}
        
      />
      <UserList 
        users={users} 
        onToggle={onToggle} 
        onRemove={onRemove}
      />
      <div>í™œì„± ì‚¬ìš©ì ìˆ˜ : {count}</div>
    </>
  )
}

export default App;

```
ì´ë ‡ê²Œ ìˆ˜ì •í•´ì£¼ê³  ë³´ë©´ ê¸°ì¡´ê³¼ ë˜‘ê°™ì´ ì‘ë™í•˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤. ì´ë ‡ê²Œ ìì£¼ì“°ëŠ” í•­ëª©ì€ use+ê¸°ëŠ¥ì´ë¦„ìœ¼ë¡œ ì»¤ìŠ¤í…€í›…ì„ ë§Œë“¤ì–´ì„œ í™œìš©í•  ìˆ˜ ìˆë‹¤ëŠ” ì  ì•Œì•„ë‘ë„ë¡ í•˜ì.  

# context APIë¥¼ ì‚¬ìš©í•œ ì „ì—­ ê°’ ê´€ë¦¬
ë¦¬ì•¡íŠ¸ë¥¼ ê°œë°œí•˜ë‹¤ë³´ë©´ ì—¬ëŸ¬ê°œì˜ ì»´í¬ë„ŒíŠ¸ê°€ ë§Œë“¤ì–´ì§€ëŠ”ë° ì–´ë–¤ propsê°’ì„ ì—¬ëŸ¬ë²ˆ ì „ë‹¬í•´ì•¼í•˜ëŠ” ìƒí™©ì´ ìƒê¸°ê³¤ í•œë‹¤. ê·¸ëŸ°ë° ê·¸ë•Œ contextAPIë¥¼ í™œìš©í•˜ë©´ propsë¥¼ ì—¬ëŸ¬ë²ˆ ì „ë‹¬í•˜ì§€ ì•Šê³  ì›í•˜ëŠ” ê³³ì— ë°”ë¡œ ì „ë‹¬í•  ìˆ˜ ìˆë‹¤. í•œë²ˆ ì½”ë“œë¡œ ì•Œì•„ë³´ë„ë¡ í•˜ì. 
ContextSampleì´ë¼ëŠ” ì»´í¬ë„ŒíŠ¸ë¥¼ ìƒˆë¡œ ë§Œë“ ë‹¤.  

> ContextSample.js  

```javascript
import React, { createContext, useContext } from 'react';

function Child({ text }) {
    return <div>ì•ˆë…•í•˜ì„¸ìš”? {text}</div>
}

function Parent({ text }){
    return <Child text={text} />
}

function GrandParent({ text }){
    return <Parent text={text} />
}

function ContextSample(){
    return <GrandParent text="GOOD" />
}

export default ContextSample;
```
![ë¦¬ì•¡íŠ¸í™”ë©´](/images/200906-2.png)
ì´ë ‡ê²Œ ë‚˜ì˜¤ëŠ” í™”ë©´ì´ ìˆë‹¤ê³  í•˜ì. ìœ„ì˜ ì½”ë“œë¥¼ ë³´ë©´ ContextSample ì•ˆì—ì„œì˜ GrandParentì˜ textê°’ìœ¼ë¡œ GOODì„ ë°˜í™˜í•˜ê³  ë˜ GrandParentì—ì„œëŠ” Parentë¡œ, Parentì—ì„œëŠ” Childë¡œ ê³„ì† ì´ê´€ë˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤. ì´ê²ƒì„ createContextì™€ useContextë¥¼ ì‚¬ìš©í•˜ë©´ ì•„ë˜ì™€ ê°™ì´ ì½”ë“œë¥¼ ì“¸ ìˆ˜ ìˆë‹¤.   
```javascript
import React, { createContext, useContext } from 'react';

const MyContext = createContext('defaultValue'); //2. MyContextì˜ ê°’ì´ ì•„ê¹Œ 1.ì˜ valueë¡œ ì„¤ì •ë¨.

function Child() {
    const text = useContext(MyContext); //3. ì•„ê¹Œ 2.ì˜ ë‚´ìš©ì„ ë³€ìˆ˜ì— ë„£ì–´ì¤Œ.
    return <div>ì•ˆë…•í•˜ì„¸ìš”? {text}</div> //4. ë³€ìˆ˜ textì— ë‹´ê¸´ê±¸ ë³´ì—¬ì¤Œ
}

function Parent(){
    return <Child />
}

function GrandParent(){
    return <Parent />
}

function ContextSample(){
    return (
        <MyContext.Provider 
        //1. MyContextë¥¼ í†µí•´ Providerë¥¼ ì„¤ì •í•´ì¤Œ. valueë¡œ ë³´ì—¬ì¤„ í…ìŠ¤íŠ¸ê°’ì„ ë„£ì–´ì¤Œ.
        value="GOOD"> 
            <GrandParent />
        </MyContext.Provider>
    )
}

export default ContextSample;
```
ì´ë ‡ê²Œ Contextë¥¼ ë§Œë“¤ì–´ì„œ ë‹¤ë¥¸ ê³³ì—ì„œë„ ê³„ì† ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤ëŠ” ì¥ì ì´ ìˆë‹¤.  
ê·¸ë¦¬ê³  ì´ MyContextì˜ valueê°’ì€ ë³€í•˜ê²Œ í• ìˆ˜ë„ ìˆë‹¤. ì•„ë˜ì˜ ì˜ˆì‹œë¥¼ ë´ë³´ì.  

```javascript
import React, { createContext, useContext, useState } from 'react';

const MyContext = createContext('defaultValue');

function Child() {
    const text = useContext(MyContext);
    return <div>ì•ˆë…•í•˜ì„¸ìš”? {text}</div>
}

function Parent(){
    return <Child />
}

function GrandParent(){
    return <Parent />
}

function ContextSample(){
    const [value, setValue] = useState(true);
    return (
        <MyContext.Provider value={value ? 'GOOD' : 'BAD'}>
            <GrandParent />
            <button onClick={() => setValue(!value)}>Click Me</button>
        </MyContext.Provider>
    )
}

export default ContextSample;
```
![ë¦¬ì•¡íŠ¸í™”ë©´](/images/200906-3.png)
ì´ë ‡ê²Œí•˜ë©´ ë²„íŠ¼ì„ í´ë¦­í• ë•Œë§ˆë‹¤ GOODì´ BADë¡œ, BADê°€ GOODìœ¼ë¡œ ë°”ë€ŒëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤. 
ìƒíƒœê°€ ë°”ë€”ë•Œë§ˆë‹¤ ê°’ì„ ê° functionì— ì „ë‹¬í•˜ëŠ”ê²ƒì´ ì•„ë‹ˆë¼ ë°”ë¡œ ì „ë‹¬í•  ìˆ˜ ìˆê²Œ ëœë‹¤. ì´ì œ í•œë²ˆ App.jsì—ì„œ ìš°ë¦¬ê°€ ë§Œë“  ì»´í¬ë„ŒíŠ¸ë¥¼ í™œìš©í•´ë³´ë„ë¡ í•˜ì.

# UserDispatch Context ë§Œë“¤ê¸°
ìš°ë¦¬ê°€ ê¸°ì¡´ì— ë§Œë“¤ì–´ë†“ì€ êµ¬ì¡° ì¤‘ App.jsì˜ í•¨ìˆ˜ì¸ onToggleê³¼ onRemoveëŠ” ë‘ê°œì˜ ìƒíƒœë¥¼ Userì»´í¬ë„ŒíŠ¸ì— ë³´ë‚´ê¸° ìœ„í•´ì„œ UserListë¥¼ ê±°ì¹˜ê³  ìˆë‹¤. ìš°ë¦¬ëŠ” ì´ê²ƒì„ UserDispatchë¼ëŠ” Contextë¥¼ ë§Œë“¤ì–´ì„œ ê°œì„ í•´ë³¼ê²ƒì´ë‹¤.  

> App.js  

```javascript
import React, { useRef, useReducer, useMemo, useCallback, createContext } from 'react';  //createContextì¶”ê°€
import UserList from './UserList';
import CreateUser from './CreateUser';
import useInputs from './useInputs';

function countActiveUsers(users){
  console.log('í™œì„± ì‚¬ìš©ì ìˆ˜ë¥¼ ì„¸ëŠ”ì¤‘...');
  return users.filter(user => user.active).length;
}

const initialState = {
  users: [
      {
        id: 1,
        username: 'bmyu',
        email: 'bomee88@naver.com',
        active: true,
    },
    {
        id: 2,
        username: 'tester',
        email: 'tester@example.com',
        active: false,
    },
    {
        id: 3,
        username: 'sample',
        email: 'sample@example.com',
        active: false,
    }
  ]
}

function reducer(state, action){
  switch (action.type){
    case 'CREATE_USER':
      return {
        inputs: initialState.inputs,
        users: state.users.concat(action.user)
      }
    case 'TOGGLE_USER':
      return {
        ...state,
        users: state.users.map(user =>
          user.id === action.id
          ? { ...user, active: !user.active }
          : user
          )
      };
    case 'REMOVE_USER':
      return {
        ...state,
        users: state.users.filter(user => user.id !== action.id)
      }
    default:
      throw new Error('Unhandled action');
  }
}

export const UserDispatch = createContext(null); //exportë¥¼ ì‚¬ìš©í•´ì„œ ì „ì—­ìœ¼ë¡œ ë‚´ë³´ë‚¼ ìˆ˜ ìˆê²Œ í•´ì¤Œ. ë°›ì•„ë³´ê³  ì‹¶ì€ ê³³ì—ì„œ importë¡œ ë¶ˆëŸ¬ì™€ì„œ ì‚¬ìš©í•˜ë©´ ë¨. (UserListì—ì„œ ë³¼ ìˆ˜ ìˆìŒ.)

function App() {
  const [state, dispatch] = useReducer(reducer, initialState);
  const [form, onChange, reset] = useInputs({
    username: '',
    email: '',
  });
  const { username, email } = form;
  const nextId = useRef(4);
  const { users } = state;


  const onCreate = useCallback(() => {
    dispatch({
      type: 'CREATE_USER',
      user: {
        id: nextId.current,
        username,
        email,
      }
    });
    nextId.current += 1;
    reset();
  }, [username, email, reset]);

  const count = useMemo(() => countActiveUsers(users),[users])

  return(
    <UserDispatch.Provider value={dispatch}>
      <CreateUser 
        username={username} 
        email={email} 
        onChange={onChange}
        onCreate={onCreate}
        
      />
      <UserList users={users} />
      <div>í™œì„± ì‚¬ìš©ì ìˆ˜ : {count}</div>
    </UserDispatch.Provider>
  )
}

export default App;

```
ê¸°ì¡´ ì½”ë“œì—ì„œ ì£¼ì„ìœ¼ë¡œ ë‹¨ ë¶€ë¶„ì„ ì¶”ê°€í–ˆë‹¤. ì•„ë˜ì˜ UserListì—ì„œ ë°›ì•„ì˜¤ëŠ” ë¶€ë¶„ì„ ìˆ˜ì •í•´ë³´ë„ë¡ í•˜ì.  

> UserList.js  

```javascript
import React, { useContext } from 'react'; //useContextë¥¼ ë¶ˆëŸ¬ì™€ì¤Œ.
import { UserDispatch } from './App'; //ì•„ê¹Œ ìœ„ì—ì„œ ë§Œë“  exportë¡œ ë³´ëƒˆë˜ UserDispatchë¥¼ ë°›ì•„ì™€ì¤Œ.

const User = React.memo(function User({ user }){ 
    const {username, email, id, active} = user;
    const dispatch = useContext(UserDispatch); //useContextë¥¼ í™œìš©í•˜ì—¬, dispatchë¡œ ì—°ë™.

    return(
        <div>
            <b
                style={{
                    color: active ? 'green' : 'black',
                    cursor: 'pointer'
                }}
                onClick={() => dispatch({ 
                    type: 'TOGGLE_USER', 
                    id 
                })}
            >
                {username}
            </b>
            &nbsp;
            <span>({email})</span>
            <button onClick={() => dispatch({ 
                type: 'REMOVE_USER', 
                id 
            })}>ì‚­ì œ</button> 
        </div>
    );
});

function UserList({ users}){
    return(
        <div>
            {
                users.map(
                    (user) => (
                        <User 
                            user={user} 
                            key={user.id}
                        />
                    )
                )
            }
        </div>
    )
}

export default React.memo(UserList);
```
ì´ë ‡ê²Œ ë°”ê¿”ë³¼ ìˆ˜ ìˆë‹¤. ë§¤ìš° ì¢‹ì€ê±° ê°™ì€ë° ê³¼ì œë¡œ ë‚´ì£¼ì‹  ë‚´ìš©ì´ ë‚´ìˆ˜ì¤€ì—” ë¬´ë¦¬ì—¬ì„œ ë‹µì•ˆì„ ì°¸ê³ í–ˆë‹¤.  
ì˜¤ëŠ˜ì€ ì—¬ê¸°ê¹Œì§€..    
ì‹œì²­ ì˜ìƒ 30ê°• 23~25ê¹Œì§€  
 
![ìˆ˜ê°•ì¸ì¦ì´ë¯¸ì§€](/images/200906-4.jpeg)   
   
í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œ ì˜¬ì¸ì› íŒ¨í‚¤ì§€ with React Online. ğŸ‘‰ https://bit.ly/31Cf1hp